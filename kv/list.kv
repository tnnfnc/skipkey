#:kivy 1.11
#---------------------------------------------------------
# List screen
#---------------------------------------------------------
<ListScreen>:
	# Properties
    pr_tag: _spi_tag
    pr_search: _inp_search
	pr_item_list_wid: _wid_itemlist
	pr_expiring: _btn_expiring
    
    BoxLayout:
        orientation: 'vertical'
        padding: ui.screen_padding
		#--------------------------------- Main buttons
		ActionBar:
		    # pos_hint: {'top':1}
			ActionView:
				use_separator: True
				ActionPrevious:
					title: app.pr_timer
					with_previous: False
					app_icon: 'data/icons/skip.png'
					previous_icon: 'data/icons/exit.png'
					on_release:
						if hasattr(app, 'timeout'): getattr(app, 'timeout')()
				# TimerLabel:
				ActionButton:
					important: True
					text: _('Back')
					icon: 'data/icons/exit.png'
					on_release: 
						if hasattr(root, 'cmd_back'): getattr(root, 'cmd_back')()
				ActionButton:
					important: True
					icon: 'data/icons/save.png'
					text: _('Save')
					on_release: 
						if hasattr(root, 'cmd_save'): getattr(root, 'cmd_save')()
						#if hasattr(app, 'save'): getattr(app, 'save')(file=app.file)
				ActionButton:
					important: True
					icon: 'data/icons/plus.png'
					text: _('Add')
					on_release: 
						if hasattr(root, 'cmd_add'): getattr(root, 'cmd_add')(args)
				# ActionOverflow:				
				ActionGroup:
					text: _('More...')
					ActionButton:
						important: False
						text: _('Copy to...')
						on_release:
							if hasattr(root, 'cmd_copy'): getattr(root, 'cmd_copy')()
					ActionButton:
						important: False
						text: _('Import from...')
						on_release:
							if hasattr(root, 'cmd_import'): getattr(root, 'cmd_import')()
					ActionButton:
						important: False
						text: _('Export as...')
						on_release:
							if hasattr(root, 'cmd_export'): getattr(root, 'cmd_export')()
					ActionButton:
						important: False
						text: _('Info')
						on_release:
							if hasattr(root, 'cmd_info'): getattr(root, 'cmd_info')()					
					ActionButton:
						important: False
						text: _('Changes')
						on_release:
							if hasattr(root, 'cmd_changes'): getattr(root, 'cmd_changes')()

        #--------------------------------- Search and Tag
        FrameTitle:
            id: _lab_account
            text: _('Personal accounts')
        GridLayout:
            rows: 1
            size_hint_y: None
            height: _spi_tag.height
			#--------------------------------- Items counter
			Label:
				id: _lab_counter
				size_hint_x: None
				width: ui.field_x #field_width_small	
			#--------------------------------- Tag
            TagSpinner:
                id: _spi_tag
				# pos_hint: {'center_y': 0.5}
                on_text:
                    if hasattr(root, 'cmd_tag_selected'): getattr(root, 'cmd_tag_selected')()
			#--------------------------------- Search cockpit
			InputField:
				id: _inp_search
				pos_hint: {'center_y': 0.5}
				hint_text: _('find')
				on_text: 
					if hasattr(root, 'cmd_search'): getattr(root, 'cmd_search')()
				on_focus:
					_spi_tag.text = _spi_tag.values[0]
			#--------------------------------- Expiring		
			ToggleButton:
				id: _btn_expiring
				size_hint_x: None
				size: (ui.button_x, ui.button_y) #small_button_size
				text: _('Expiring')
				on_state:
					if hasattr(root, 'cmd_expiring'): getattr(root, 'cmd_expiring')(*args)
        #--------------------------------- List of items
		BBoxLayout:
			orientation: 'horizontal'
			AccountItemList:
				id: _wid_itemlist

