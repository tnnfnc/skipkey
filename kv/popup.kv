#:kivy 1.11
##-------------------------- POPUP
#---------------------------------------------------------
# Login Popup
#---------------------------------------------------------
<LoginPopup>:
    # Properties: Login and seed
    pr_login_wid: _wid_login
    pr_seed_wid: _wid_seed

	auto_dismiss: False
	size_hint: 0.9, 0.9
	size_hint_max_x: 2 * ui.field_bigger_x #2*field_width_long
	BoxLayout:
		orientation: "vertical"
		#--------------------------------- Password for data encryption
		FrameTitle:
			id: _lab_pwd
			text: _('Password for data encryption')
		GridLayout:
			cols: 3
			size_hint_y: None
			height: 3 * ui.field_y #field_height
			Widget:
				size_hint_x: 0.2
			LoginPanel:
				id: _wid_login
				size_hint_max_x: ui.field_bigger_x #field_width_long
			Widget:
				size_hint_x: 0.2
			#--------------------------------- Seed for password generation
		FrameTitle:
			id: _lab_seed
			text: _('Seed for password generation')
		GridLayout:
			cols: 3
			size_hint_y: None
			height: 3 * ui.field_y #field_height
			Widget:
				size_hint_x: 0.2
			SeedPanel:
				id: _wid_seed
				size_hint_max_x: ui.field_bigger_x #field_width_long
			Widget:
				size_hint_x: 0.2
		#--------------------------------- Main buttons
		GridLayout:
			cols: 3
			Widget:
			NavButton:
				id: _btn_exit
				text: _('Cancel')
				on_release:
					if hasattr(root, 'cmd_exit'): getattr(root, 'cmd_exit')()
			NavButton:
				id: _btn_file
				text: _('Enter')
				on_release: 
					if hasattr(root, 'cmd_enter'): getattr(root, 'cmd_enter')()
#---------------------------------------------------------
# CipherPopup Popup
#---------------------------------------------------------
<CipherPopup>:
    # Properties: Login and seed
    pr_login_wid: _wid_login
	pr_seed_wid: _wid_seed
	pr_kderive: _spi_kderive
	pr_cipher: _spi_cipher
	pr_iters: _inp_iters

	auto_dismiss: False
	size_hint: 0.9, 0.9
	size_hint_max_x: 2 * ui.field_bigger_x #field_width_long
	BoxLayout:
		orientation: "vertical"
		GridLayout:
			cols: 2
			size_hint_y: None
			height: 2 * ui.spinner_y #spinner_size[1] * 2
			#--------------------------------- Cipher
			FieldLabel:
				id: _lab_cipher
				text: _('Cipher')
			Spinner:
				id: _spi_cipher
				size_hint: None, 1
				size: (ui.spinner_x, ui.spinner_y) #spinner_size
				text: root.cipher_algorithms()[0]
				values:
					root.cipher_algorithms() 
			#--------------------------------- Key generation			
			FieldLabel:
				id: _lab_keygen
				text: _('Key generation')
			BoxLayout:
				orientation: 'horizontal'
				Spinner:
					id: _spi_kderive
					size_hint: None, 1
					size: (ui.spinner_x, ui.spinner_y) #spinner_size
					text: root.key_derivators()[0]
					values:
						root.key_derivators() 
				FieldLabel:
					id: _lab_iters
					text: _('Iters.')
				InputField:
					id: _inp_iters
					width: ui.field_x # field_width_small
					text: '100000'
		#--------------------------------- Password for data encryption
		FrameTitle:
			id: _lab_pwd
			text: _('Password for data encryption')
			size_hint_y: None
		GridLayout:
			cols: 3
			size_hint_y: None
			height: 5 * ui.field_y #field_height
			Widget:
				size_hint_x: 0.2
			UserPanel:
				id: _wid_login
				size_hint_max_x: ui.field_bigger_x #field_width_long
			Widget:
				size_hint_x: 0.2
		#--------------------------------- Seed
		FrameTitle:
			id: _lab_seed
			text: _('Seed for password generation')
			size_hint_y: None
		GridLayout:
			cols: 3
			size_hint_y: None
			height: 3 * ui.field_y #field_height
			Widget:
				size_hint_x: 0.2
			SeedPanel:
				id: _wid_seed
				size_hint_max_x: ui.field_bigger_x #field_width_long
			Widget:
				size_hint_x: 0.2
		#--------------------------------- Main buttons
		GridLayout:
			cols: 3
			Widget:
			NavButton:
				id: _btn_exit
				text: _('Cancel')
				on_release:
					if hasattr(root, 'cmd_exit'): getattr(root, 'cmd_exit')()
			NavButton:
				id: _btn_file
				text: _('OK')
				on_release: 
					if hasattr(root, 'cmd_enter'): getattr(root, 'cmd_enter')()
#---------------------------------------------------------
#-------------------- EDIT TAG POPUP
#---------------------------------------------------------
<EditTagPopup>:
	## Properties
    pr_tag: _inp_tag
	
    auto_dismiss: False
	size_hint: 0.9, 0.5
	size_hint_max_x: 1 * ui.field_bigger_x #field_width_long
    BoxLayout:
        orientation: 'vertical'
		InputField:
			id: _inp_tag
			hint_text: _('Custom tag')
			size:  (ui.field_big_x, ui.field_big_y) #field_size_med
			on_text:
				if len(self.text) > 20: self.text = self.text[:-1]
			on_focus:
				if hasattr(root, 'cmd_focus_tag'): getattr(root, 'cmd_focus_tag')(args)
			on_parent:
				self.focus = True
		BoxLayout:
        GridLayout:
            cols: 3
			Widget:
            NavButton:
                id: _btn_save
                text: _('Cancel')
                on_release:
                    if hasattr(root, 'cmd_cancel'): getattr(root, 'cmd_cancel')(args)           
			NavButton:
                id: _btn_save
                text: _('OK')
                on_release:
                    if hasattr(root, 'cmd_save'): getattr(root, 'cmd_save')()
#---------------------------------------------------------
#-------------------- INFO POPUP
#---------------------------------------------------------
<InfoPopup>:
    # Properties: Login and seed
	pr_file: _out_file
	pr_pbkdf: _out_pbkdf
	pr_algorithm: _out_algorithm
	pr_mode: _out_mode
	pr_keysize: _out_keysize
	pr_iterations: _out_iterations

    auto_dismiss: False
	size_hint: 0.9, 0.9
	# pos: root.pos
    # padding: screen_padding
    BoxLayout:
        orientation: 'vertical'
		FrameTitle:
			text: _('Info')
		BoxLayout:
			orientation: 'horizontal'
			FieldLabel:
				text: _('File')
				size_hint_x: 0.3
			OutputField:
				id: _out_file
				text: ''
		FrameTitle:
			text: _('Security')
		GridLayout:
			cols: 2
			FieldLabel:
				text: _('Algorithm')
				size_hint_x: 0.5
			OutputField:
				id: _out_algorithm
				text: ''
			FieldLabel:
				text: _('Chain mode')
				size_hint_x: 0.5
			OutputField:
				id: _out_mode
				text: ''
			FieldLabel:
				text: _('Key size')
				size_hint_x: 0.5
			OutputField:
				id: _out_keysize
				text: ''
			FieldLabel:
				text: _('Key derivator')
				size_hint_x: 0.5
			OutputField:
				id: _out_pbkdf
				text: ''
			FieldLabel:
				text: _('Iterations')
				size_hint_x: 0.5
			OutputField:
				id: _out_iterations
				text: ''
        BoxLayout:
			orientation: 'vertical'
		NavButton:
			id: _btn_cancel
			pos_hint: {'x': 0}
			text: _('Cancel')
			on_release:
				if hasattr(root, 'cmd_cancel'): getattr(root, 'cmd_cancel')()
				root.dismiss()